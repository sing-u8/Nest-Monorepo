🏗️ 클린 아키텍처 종합 가이드 #클린아키텍처 #로버트C마틴
로버트 C. 마틴의 클린 아키텍처는 동심원(양파 구조) 형태로 설계되며, 핵심 원칙은 바로 의존성 규칙(The Dependency Rule)입니다.

Pasted image 20250718230725.png

🎯 핵심 원칙: 의존성 규칙
"소스 코드 의존성은 오직 안쪽으로만, 더 높은 수준의 정책을 향해서만 향해야 한다."

즉, 안쪽 원은 바깥쪽 원에 대해 아무것도 알지 못합니다. 이는 시스템의 안정성과 유연성을 보장하는 핵심 메커니즘입니다.

📊 네 가지 주요 계층 (안쪽부터 바깥쪽으로)
🔴 1. 엔티티 (Entities) - 가장 안쪽 계층
역할: 전사적인 핵심 업무 규칙(Enterprise-wide business rules)을 캡슐화

특징:

가장 일반적이고 높은 수준의 규칙을 담고 있습니다
애플리케이션의 핵심 비즈니스 로직과 데이터를 포함하는 객체
가장 안정적인 중심부로, 외부의 어떤 계층 변경에도 영향받지 않음
도메인 객체나 데이터 구조와 이를 조작하는 함수들이 포함
실제 예시:

은행 시스템: Account(계좌), Customer(고객), Transaction(거래) 클래스
전자상거래: Product(상품), Order(주문), User(사용자) 엔티티
🟢 2. 유스케이스 (Use Cases) - 애플리케이션 비즈니스 로직
역할: 애플리케이션에 특화된 업무 규칙(Application-specific business rules)을 포함

특징:

시스템이 사용되는 시나리오, 즉 '유스케이스'를 구현
엔티티들의 흐름을 조합하고 제어하여 특정 사용 사례를 완성
시스템이 사용자에게 제공하는 서비스를 정의
UI나 데이터베이스 변경에 영향받지 않음
실제 예시:

WithdrawMoney(출금하기): 계좌에서 돈을 출금하는 로직
ProcessOrder(주문처리): 상품 주문을 처리하는 비즈니스 플로우
RegisterUser(사용자등록): 새로운 사용자를 시스템에 등록
🔵 3. 인터페이스 어댑터 (Interface Adapters) - 데이터 변환 계층
역할: 데이터를 변환하고 외부 세계와 내부 계층을 연결하는 어댑터의 집합

특징:

유스케이스와 엔티티에게 편리한 형식과 외부 형식 간의 데이터 변환
MVC 패턴의 컨트롤러, 프레젠터, 뷰, 게이트웨이가 이 계층에 속함
외부 형식에서 내부 형식으로, 또는 그 반대로 데이터를 변환
구성 요소:

컨트롤러(Controllers): HTTP 요청을 받아 유스케이스를 호출
프레젠터(Presenters): 유스케이스 결과를 UI에 맞는 형태로 변환
게이트웨이(Gateways): 데이터베이스나 외부 서비스와의 인터페이스
🟣 4. 프레임워크와 드라이버 (Frameworks & Drivers) - 가장 바깥쪽 계층
역할: 가장 바깥쪽 계층으로, 모든 세부 사항이 위치

특징:

데이터베이스, 웹 프레임워크, UI 프레임워크, 서드파티 라이브러리 등
시스템의 다른 부분들과 "접착제" 역할을 하는 코드
가장 변동성이 크고 시스템의 가장 낮은 수준의 세부 사항
비즈니스 로직이 거의 없음
실제 예시:

웹 프레임워크: Spring Boot, Express.js, Django
데이터베이스: MySQL, PostgreSQL, MongoDB
UI 프레임워크: React, Angular, Vue.js
🔄 의존성 역전과 경계선
의존성 역전 원칙 (Dependency Inversion Principle)
// ❌ 잘못된 방법: 유스케이스가 구체적인 데이터베이스에 의존
public class UserService {
    private MySQLUserRepository repository; // 구체적인 구현에 의존
}

// ✅ 올바른 방법: 인터페이스를 통한 의존성 역전
public class UserService {
    private UserRepository repository; // 인터페이스에 의존
}
경계선에서의 데이터 변환
각 계층 사이에서는 데이터 형식이 해당 계층에 맞게 변환됩니다:

DB Row → Gateway → Domain Object → Use Case → DTO → Controller → JSON
🌟 클린 아키텍처의 핵심 이점
1. 🔧 테스트 용이성
비즈니스 로직을 UI, 데이터베이스, 웹 서버 없이도 독립적으로 테스트 가능
각 계층을 격리하여 단위 테스트 작성이 용이
2. 🔄 유연성과 교체 가능성
프레임워크, 데이터베이스, UI를 쉽게 교체 가능
예: MySQL → PostgreSQL 변경 시 비즈니스 로직은 영향받지 않음
3. 📦 독립성
외부 도구나 라이브러리에 의존하지 않는 독립적인 아키텍처
프레임워크는 도구일 뿐, 아키텍처를 지배하지 않음
4. 🎯 관심사의 분리
각 계층이 명확한 책임을 가지며 서로 다른 이유로 변경
코드의 가독성과 유지보수성 향상
📁 실제 패키지 구조 예시
src/
├── entities/                    # 🔴 엔티티 계층
│   ├── User.java
│   ├── Account.java
│   └── Transaction.java
│
├── usecases/                   # 🟢 유스케이스 계층
│   ├── WithdrawMoney.java
│   ├── CreateAccount.java
│   └── TransferFunds.java
│
├── interfaces/                 # 🔵 인터페이스 어댑터
│   ├── controllers/
│   │   └── AccountController.java
│   ├── presenters/
│   │   └── AccountPresenter.java
│   └── gateways/
│       └── AccountGateway.java
│
└── frameworks/                 # 🟣 프레임워크 & 드라이버
    ├── web/
    │   └── SpringWebConfig.java
    ├── database/
    │   └── JpaAccountRepository.java
    └── external/
        └── EmailService.java
이러한 구조를 통해 클린 아키텍처는 "세부사항이 정책에 의존하고, 정책이 세부사항에 의존하지 않는" 시스템을 구축할 수 있게 해줍니다.